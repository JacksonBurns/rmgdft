RMG initialization ... 1 image(s) total, 1 per node. 16 MPI processes/image. Thread level 2.


                     * * * * * * * * * *
                     *    R   M   G    *
                     * * * * * * * * * *

     -- A Real Space Multigrid Electronic structure code --
     --      More information at www.rmgdft.org          --

Code Revision:     5.0.0_beta1_135_ga9bc109b
Build Date:        Mar 29 2023  18:32:46
Start time:        Wed Mar 29 18:42:07 2023

NOTICE: RMG internal pseudopotentials have switched to
ONCVP from Ultrasoft. You can revert to Ultrasoft by
adding the input tag internal_pseudo_type="ultrasoft" to
your input files.


Files
   Control input file:        input
   Data output file:          /dev/null

Run Setup
    Calculation type:         Quench electrons - Fixed ions SCF calculation
    Description:              Nickel atom test using semi-local potential
    Orbital Initialization:   LCAO (9 LCAO and 0 random orbitals)
    Exchange Correlation:     pbe
    Spin Polarization:        OFF
    System charge:            Neutral

Processor Topology
   Total PEs:                 16
   X direction:               4
   Y direction:               2
   Z direction:               2
   MG Threads/PE:             2
   OMP Threads/PE:            2

Grid Points  (Linear Anisotropy: 1.000)
    X:  Total: 96   Per PE: 24   Spacing:0.188 a0  
    Y:  Total: 96   Per PE: 48   Spacing:0.188 a0  
    Z:  Total: 96   Per PE: 48   Spacing:0.188 a0  

    Equivalent energy cutoffs (psi,rho):   280.735   1122.942 Ry

    Charge density grid:         2 times finer

Coordinate planes
  Planar Anisotropy: 1.000
  A0-A1 density:    28.444
  A0-A2 density:    28.444
  A1-A2 density:    28.444


Lattice (Cell) Setup
    Type:                       Cubic_primitive
    Volume (a0^3):               5832.00
    Boundary conditions:        Periodic

    X Basis Vector:      18.000       0.000       0.000 a0
    Y Basis Vector:       0.000      18.000       0.000 a0
    Z Basis Vector:       0.000       0.000      18.000 a0
    X Reci Vector:       0.056      -0.000       0.000 a0
    Y Reci Vector:       0.000       0.056       0.000 a0
    Z Reci Vector:       0.000      -0.000       0.056 a0

K-points
    Gamma Point Only (real orbitals)

Atoms and States
    Number of ions:                          1
    Number of species:                       1
    Number of states:                        16

Run Parameters
    SCF Convergence criterion (potential):   1.00e-07
    SCF Convergence criterion (energy):      1.00e-11
    Max SCF steps:                           100

SCF Cycle Settings
    Charge density mixing:                   Broyden
    Hartree Solver:                          PFFT
    Interpolation type:                      FFT

Subspace Diagonalization Options
    Frequency:                               every 1 SCF step(s)
    Driver:                                  ScaLapack
    Initial diagonalization:                 ON
    Folded spectrum:                         OFF

Filtering Cutoff  Parameters
    Wavefunction grid (cparm):               0.800
    Charge density grid (rhocparm):          1.000
    Filter factor:                           1.000

Multigrid (MG) Parameters
    Psi MG levels:                           3
    Psi global step:                         0.660 
    Psi pre:                                 2
    Psi post:                                2

Davidson Parameters
    Davidson multiplier:                     4
    Davidson max step:                       8
    Davidson unocc tol factor:               1000.000

Blas Libraries
    CPU support with openblas-parallel.


Atomic Species Information
(PP = Pseudopotential, US = Ultrasoft, NC = Norm Conserving)
-------------------------------------------------------------------------
|Index|Symbol| Mass|Valence| PP |  Comp  |Local| Local|Nlocal|    PP    |
|     |      |     |       |Type|Gaussian|  l  |Radius|Radius|Functional|
-------------------------------------------------------------------------
|    1|    Ni| 58.0|  16.00|  NC|    0.50|   -1| 10.00|  8.91|       PBE|
-------------------------------------------------------------------------

Pseudopotential generation information:
  Ni pseudopotential file: Ni_ONCV_PBE-1.0_SL.UPF
      Generation info     : Generated using ONCVPSP code by D. R. Hamann
      Author info         : anonymous


Memory usage (Mbytes):     Min        Max       Total
    wave functions         28.31      28.31     453.00
    beta-functions         39.81      39.81     637.03



Initial Ionic Positions And Displacements (Bohr)
Species      X           Y           Z           dX          dY          dZ
  Ni       0.0000      0.0000      0.0000      0.0000      0.0000      0.0000


Initial Ionic Positions And Displacements (Angstrom)
Species      X           Y           Z           dX          dY          dZ
  Ni       0.0000      0.0000      0.0000      0.0000      0.0000      0.0000

Diagonalization using scalapack for step=0  count=0



KOHN SHAM EIGENVALUES [eV] AT K-POINT [  0]:       0.000000      0.000000      0.000000

[kpt   0  -1   0]   -70.9213 [2.000]   -70.9213 [2.000]   -70.9213 [2.000]    -8.4236 [1.600]    -8.4236 [1.600]
[kpt   0  -1   1]    -8.4231 [1.600]    -8.4231 [1.600]    -8.4231 [1.600]    -5.2535 [2.000]   813.6329 [0.000]
[kpt   0  -1   2]   1632.0840 [0.000]   1694.4729 [0.000]   1755.0309 [0.000]   1854.6561 [0.000]   1913.9101 [0.000]
[kpt   0  -1   3]   1922.5032 [0.000]


Charge density mixing: Linear with a constant of 0.50 

 charge density is NEGATIVE after interpolation, minimum is -2.221505e-09
 minimum charge density with core charge added is -2.221505e-09

Diagonalization using scalapack for step=0  count=1


FERMI ENERGY =     -5.26923371 eV
@@ EIGENVALUE SUM     =      -18.529344 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.289208 Ha
@@ VXC                =      -15.795314 Ha
@@ EXC                =      -12.144946 Ha
@@ TOTAL ENERGY       =     -113.344522 Ha
@@ estimated error    =   ****************
Charge density mixing: Linear with a constant of 0.50 
WriteRestart: Output file given as /dev/null, no restart data written ...


KOHN SHAM EIGENVALUES [eV] AT K-POINT [  0]:       0.000000      0.000000      0.000000

[kpt   0   0   0]   -70.9833 [2.000]   -70.9833 [2.000]   -70.9833 [2.000]    -8.4716 [1.600]    -8.4716 [1.600]
[kpt   0   0   1]    -8.4712 [1.600]    -8.4712 [1.600]    -8.4712 [1.600]    -5.2692 [2.000]     0.4769 [0.000]
[kpt   0   0   2]     8.4482 [0.000]    10.8518 [0.000]    14.3075 [0.000]    17.2094 [0.000]    20.7505 [0.000]
[kpt   0   0   3]    23.6401 [0.000]



Total charge in supercell =      16.00000000
 quench: [md:   0/100  scf:   0/100  step time:   1.37  scf time:     1.41 secs  RMS[dV]: 7.46e-03 ]


average potential <V> = 1.23e-15

Diagonalization using scalapack for step=1  count=2


FERMI ENERGY =     -5.29444704 eV
@@ EIGENVALUE SUM     =      -18.558656 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.254838 Ha
@@ VXC                =      -15.791162 Ha
@@ EXC                =      -12.141912 Ha
@@ TOTAL ENERGY       =     -113.340581 Ha
@@ estimated error    =        1.63e-05 Ha
Charge density mixing: Linear with a constant of 0.50 
 quench: [md:   0/100  scf:   1/100  step time:   1.50  scf time:     2.91 secs  RMS[dV]: 4.72e-03 ]


average potential <V> = 3.31e-15

Diagonalization using scalapack for step=2  count=3


FERMI ENERGY =     -5.30621385 eV
@@ EIGENVALUE SUM     =      -18.573396 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.239477 Ha
@@ VXC                =      -15.789390 Ha
@@ EXC                =      -12.140598 Ha
@@ TOTAL ENERGY       =     -113.340419 Ha
@@ estimated error    =        3.37e-06 Ha
Charge density mixing: Linear with a constant of 0.50 
 quench: [md:   0/100  scf:   2/100  step time:   1.42  scf time:     4.33 secs  RMS[dV]: 1.95e-03 ]


average potential <V> = -2.96e-16

Diagonalization using scalapack for step=3  count=4


FERMI ENERGY =     -5.30973065 eV
@@ EIGENVALUE SUM     =      -18.577662 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.235746 Ha
@@ VXC                =      -15.788998 Ha
@@ EXC                =      -12.140353 Ha
@@ TOTAL ENERGY       =     -113.341100 Ha
@@ estimated error    =        3.38e-07 Ha
Charge density mixing: Linear with a constant of 0.50 
 quench: [md:   0/100  scf:   3/100  step time:   1.49  scf time:     5.81 secs  RMS[dV]: 8.36e-03 ]


average potential <V> = -9.70e-16
Davidson incomplete convergence steps = 8

FERMI ENERGY =     -5.30980316 eV
@@ EIGENVALUE SUM     =      -18.577656 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.236593 Ha
@@ VXC                =      -15.789063 Ha
@@ EXC                =      -12.140511 Ha
@@ TOTAL ENERGY       =     -113.342034 Ha
@@ estimated error    =        1.04e-07 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   4/100  step time:   2.80  scf time:     8.62 secs  RMS[dV]: 4.68e-02 ]


average potential <V> = -5.59e-16
Davidson converged in 4 steps

FERMI ENERGY =     -5.30682253 eV
@@ EIGENVALUE SUM     =      -18.572547 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.241947 Ha
@@ VXC                =      -15.789940 Ha
@@ EXC                =      -12.141030 Ha
@@ TOTAL ENERGY       =     -113.341923 Ha
@@ estimated error    =        5.56e-07 Ha
Charge density mixing: Broyden


KOHN SHAM EIGENVALUES [eV] AT K-POINT [  0]:       0.000000      0.000000      0.000000

[kpt   0   5   0]   -71.0646 [2.000]   -71.0646 [2.000]   -71.0646 [2.000]    -8.5483 [1.600]    -8.5483 [1.600]
[kpt   0   5   1]    -8.5477 [1.600]    -8.5477 [1.600]    -8.5477 [1.600]    -5.3068 [2.000]    -0.0970 [0.000]
[kpt   0   5   2]    -0.0913 [0.000]    -0.0912 [0.000]    -0.0911 [0.000]     1.1562 [0.000]     1.1565 [0.000]
[kpt   0   5   3]     2.0055 [0.000]



Total charge in supercell =      16.00000000
 quench: [md:   0/100  scf:   5/100  step time:   1.62  scf time:    10.24 secs  RMS[dV]: 5.51e-02 ]


average potential <V> = -1.00e-15
Davidson converged in 3 steps

FERMI ENERGY =     -5.30646656 eV
@@ EIGENVALUE SUM     =      -18.572073 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.242431 Ha
@@ VXC                =      -15.789989 Ha
@@ EXC                =      -12.141070 Ha
@@ TOTAL ENERGY       =     -113.341923 Ha
@@ estimated error    =        1.85e-08 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   6/100  step time:   1.17  scf time:    11.41 secs  RMS[dV]: 3.31e-04 ]


average potential <V> = 2.71e-15
Davidson converged in 3 steps

FERMI ENERGY =     -5.30653315 eV
@@ EIGENVALUE SUM     =      -18.572382 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.242107 Ha
@@ VXC                =      -15.789933 Ha
@@ EXC                =      -12.141029 Ha
@@ TOTAL ENERGY       =     -113.341923 Ha
@@ estimated error    =        3.90e-09 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   7/100  step time:   1.39  scf time:    12.80 secs  RMS[dV]: 2.56e-04 ]


average potential <V> = -9.05e-16
Davidson converged in 3 steps

FERMI ENERGY =     -5.30648882 eV
@@ EIGENVALUE SUM     =      -18.572260 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.242233 Ha
@@ VXC                =      -15.789953 Ha
@@ EXC                =      -12.141044 Ha
@@ TOTAL ENERGY       =     -113.341923 Ha
@@ estimated error    =        5.61e-10 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   8/100  step time:   1.37  scf time:    14.17 secs  RMS[dV]: 6.84e-05 ]


average potential <V> = 6.74e-16
Davidson converged in 3 steps

FERMI ENERGY =     -5.30650868 eV
@@ EIGENVALUE SUM     =      -18.572231 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.242265 Ha
@@ VXC                =      -15.789962 Ha
@@ EXC                =      -12.141052 Ha
@@ TOTAL ENERGY       =     -113.341923 Ha
@@ estimated error    =        5.15e-11 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   9/100  step time:   1.40  scf time:    15.57 secs  RMS[dV]: 9.85e-05 ]


average potential <V> = 1.55e-15
Davidson converged in 3 steps

FERMI ENERGY =     -5.30651164 eV
@@ EIGENVALUE SUM     =      -18.572246 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.242249 Ha
@@ VXC                =      -15.789959 Ha
@@ EXC                =      -12.141050 Ha
@@ TOTAL ENERGY       =     -113.341923 Ha
@@ estimated error    =        1.16e-11 Ha
Charge density mixing: Broyden


KOHN SHAM EIGENVALUES [eV] AT K-POINT [  0]:       0.000000      0.000000      0.000000

[kpt   0  10   0]   -71.0641 [2.000]   -71.0641 [2.000]   -71.0641 [2.000]    -8.5477 [1.600]    -8.5477 [1.600]
[kpt   0  10   1]    -8.5471 [1.600]    -8.5471 [1.600]    -8.5471 [1.600]    -5.3065 [2.000]    -0.1012 [0.000]
[kpt   0  10   2]    -0.0920 [0.000]    -0.0920 [0.000]    -0.0920 [0.000]     1.1512 [0.000]     1.1512 [0.000]
[kpt   0  10   3]     2.0020 [0.000]



Total charge in supercell =      16.00000000
 quench: [md:   0/100  scf:  10/100  step time:   1.39  scf time:    16.96 secs  RMS[dV]: 4.23e-05 ]



 Convergence criterion reached: Energy variation (6.61e-13) is lower than threshold (1.00e-11)

potential convergence has been achieved. stopping ...

[   0  11   11       19 ] Quench.cpp: final total energy =    -113.34192292 Ha


KOHN SHAM EIGENVALUES [eV] AT K-POINT [  0]:       0.000000      0.000000      0.000000

[kpt   0  11   0]   -71.0641 [2.000]   -71.0641 [2.000]   -71.0641 [2.000]    -8.5477 [1.600]    -8.5477 [1.600]
[kpt   0  11   1]    -8.5471 [1.600]    -8.5471 [1.600]    -8.5471 [1.600]    -5.3065 [2.000]    -0.1012 [0.000]
[kpt   0  11   2]    -0.0920 [0.000]    -0.0920 [0.000]    -0.0920 [0.000]     1.1512 [0.000]     1.1512 [0.000]
[kpt   0  11   3]     2.0020 [0.000]



Total charge in supercell =      16.00000000
 volume and energy per atom =       864.21323680      -3084.19064443 eV

 Vdd took 0.001481 seconds
WriteRestart: Output file given as /dev/null, no restart data written ...



  IONIC POSITIONS [a0] AND FORCES [Ha/a0]
  Charge analysis using: Voronoi Deformation Density

@ION  Ion  Species       X           Y           Z       Charge       FX          FY         FZ      Movable
@ION    1    Ni      0.0000000   0.0000000   0.0000000   -0.000    0.0000000   0.0000000   0.0000000  1 1 1

 mean FX      =   0.00000000 Ha/a0
 mean FY      =   0.00000000 Ha/a0
 mean FZ      =   0.00000000 Ha/a0

 max FX       =   0.00000000 Ha/a0   (ion 1)
 max FY       =   0.00000000 Ha/a0   (ion 1)
 max FZ       =   0.00000000 Ha/a0   (ion 1)
 max F[x,y,z] =   0.00000000 Ha/a0
 max |F|      =   0.00000000 Ha/a0   (ion 1)

WriteRestart: Output file given as /dev/null, no restart data written ...


--------TIMING INFORMATION FOR Processor owned the most atoms----------------
                                        Total time               Per SCF/step

1-TOTAL                                            19.42                1.77
-----------------------------------------------------------------------------
  1-TOTAL: Init                                     2.21                0.20
  1-TOTAL: run                                     17.22                1.57
  ---------------------------------------------------------------------------
    1-TOTAL: run: Force                             0.18                0.02
    1-TOTAL: run: Scf steps                        16.92                1.54

2-Force                                             0.18                0.02
-----------------------------------------------------------------------------
  2-Force: core correction                          0.00                0.00
  2-Force: corrections                              0.04                0.00
  2-Force: ion-ion                                  0.02                0.00
  2-Force: local                                    0.05                0.00
  2-Force: non-local                                0.06                0.01
  2-Force: non-local-betaxpsi                       0.03                0.00
  2-Force: non-local-get gamma                      0.00                0.00
  2-Force: non-local-nlforce_par_Q                  0.01                0.00
  2-Force: non-local-nlforce_par_gamma              0.00                0.00
  2-Force: non-local-nlforce_par_omega              0.00                0.00
  2-Force: non-local-partial gamma                  0.00                0.00
  2-Force: non-local-veff grad                      0.01                0.00

2-Init                                              2.21                0.20
-----------------------------------------------------------------------------
  2-Init: GetNewRho                                 0.09                0.01
  2-Init: KpointClass                               0.39                0.04
  2-Init: LcaoGetPsi                                0.04                0.00
  2-Init: LcaoGetRho                                0.03                0.00
  2-Init: ReinitIonicPotentials                     0.44                0.04
  2-Init: betaxpsi                                  0.03                0.00
  2-Init: exchange/correlation                      0.19                0.02
  2-Init: hartree                                   0.18                0.02
  2-Init: normalization                             0.00                0.00
  2-Init: radial potentials                         0.17                0.02
  2-Init: subdiag                                   0.11                0.01
  2-Init: weights                                   0.22                0.02

2-Scf steps                                        16.92                1.54
-----------------------------------------------------------------------------
  2-Scf steps: Davidson                             7.34                0.67
  2-Scf steps: GetNewRho                            0.94                0.09
  2-Scf steps: Hartree                              2.14                0.19
  2-Scf steps: MgridSubspace                        3.69                0.34
  2-Scf steps: MixRho                               0.26                0.02
  2-Scf steps: exchange/correlation                 1.18                0.11

3-MgridSubspace                                     3.69                0.34
-----------------------------------------------------------------------------
  3-MgridSubspace: AppNls                           0.14                0.01
  3-MgridSubspace: Beta x psi                       0.34                0.03
  3-MgridSubspace: Diagonalization                  0.51                0.05
  3-MgridSubspace: Mg_eig                           0.00                0.00

3-ReinitIonicPotentials                             0.44                0.04
-----------------------------------------------------------------------------
  3-ReinitIonicPotentials: GetNlop                  0.02                0.00
  3-ReinitIonicPotentials: GetWeight                0.32                0.03
  3-ReinitIonicPotentials: get_QI                   0.00                0.00
  3-ReinitIonicPotentials: get_qqq                  0.00                0.00
  3-ReinitIonicPotentials: init_nuc                 0.10                0.01

4-Diagonalization                                   0.62                0.06
-----------------------------------------------------------------------------
  4-Diagonalization: ELPA/PDSYGVX/PZHEGVX           0.00                0.00
  4-Diagonalization: Hpsi                           0.42                0.04
  4-Diagonalization: MPI_Bcast                      0.00                0.00
  4-Diagonalization: Update orbitals                0.03                0.00
  ---------------------------------------------------------------------------
    4-Diagonalization: Update orbitals: gather           0.00                0.00
    4-Diagonalization: Update orbitals: gemm           0.01                0.00
  4-Diagonalization: matrix                         0.15                0.01
  ---------------------------------------------------------------------------
    4-Diagonalization: matrix: Allreduce            0.08                0.01
    4-Diagonalization: matrix: Gemm                 0.07                0.01

5-Functional                                        1.28                0.12
-----------------------------------------------------------------------------
  5-Functional: apply gradient                      0.36                0.03
  5-Functional: apply laplacian                     0.08                0.01
  5-Functional: libxc                               0.36                0.03
  5-Functional: vxc                                 1.24                0.11
  5-Functional: vxc grad                            0.91                0.08
  5-Functional: vxc local                           0.22                0.02
  5-Functional: vxc nonlocal                        0.00                0.00

6-Davidson                                          7.34                0.67
-----------------------------------------------------------------------------
  6-Davidson: Betaxpsi                              0.80                0.07
  6-Davidson: apply hamiltonian                     1.99                0.18
  6-Davidson: diagonalization                       0.06                0.01
  6-Davidson: generate residuals                    0.25                0.02
  6-Davidson: matrix setup/reduce                   0.70                0.06
  6-Davidson: normalization                         0.29                0.03
  6-Davidson: precondition                          3.16                0.29
  6-Davidson: refresh h_psi and s_psi               0.02                0.00
  6-Davidson: reset hr,sr,vr                        0.00                0.00
  6-Davidson: rotate orbitals                       0.06                0.01

AppNls                                              0.58                0.05
-----------------------------------------------------------------------------
  AppNls: data_rearrange                            0.00                0.00
  ---------------------------------------------------------------------------
    AppNls: data_rearrange: alloc and zeros           0.00                0.00
    AppNls: data_rearrange: dnm                     0.00                0.00
    AppNls: data_rearrange: sint                    0.00                0.00
  AppNls: nv                                        0.53                0.05
  AppNls: nv_work                                   0.00                0.00

App_gradient                                        0.41                0.04

Compute Hpsi                                        0.42                0.04
-----------------------------------------------------------------------------
  Compute Hpsi: AppNls                              0.06                0.01
  Compute Hpsi: Threaded Apply H                    0.36                0.03

GlobalSums                                          0.11                0.01

Init                                                1.82                0.17

Init Voronoi                                        0.04                0.00

Mix rho                                             0.27                0.02
-----------------------------------------------------------------------------
  Mix rho: Broyden                                  0.20                0.02
  Mix rho: Linear                                   0.01                0.00

Orbital                                             0.02                0.00
-----------------------------------------------------------------------------
  Orbital: phase and set                            0.02                0.00
  Orbital: proj cal                                 0.02                0.00

VhPfft                                              2.17                0.20

Weight                                              0.20                0.02

radial beta                                         0.09                0.01


------------------------- TIMING INFORMATION FOR THREADS  -------------------

                                           Min            Max            Avg
GlobalSums                               1.44           1.44           0.72
-----------------------------------------------------------------------------

Mg_eig                                   2.68           2.68           1.34
-----------------------------------------------------------------------------
  Mg_eig: apply hamiltonian              0.94           0.94           0.47
  Mg_eig: mgrid_solv                     0.73           0.73           0.36

RMG initialization ... 1 image(s) total, 1 per node. 16 MPI processes/image. Thread level 2.


                     * * * * * * * * * *
                     *    R   M   G    *
                     * * * * * * * * * *

     -- A Real Space Multigrid Electronic structure code --
     --      More information at www.rmgdft.org          --

Code Revision:     v5.3.0_46_gd7d714f1
Build Date:        Jun  6 2023  13:39:29
Start time:        Tue Jun  6 14:11:00 2023

NOTICE: RMG internal pseudopotentials have switched to
ONCVP from Ultrasoft. You can revert to Ultrasoft by
adding the input tag internal_pseudo_type="ultrasoft" to
your input files.


Files
   Control input file:        input
   Data output file:          /dev/null

Run Setup
    Calculation type:         Quench electrons - Fixed ions SCF calculation
    Description:              Nickel atom test using semi-local potential
    Orbital Initialization:   LCAO (9 LCAO and 0 random orbitals)
    Exchange Correlation:     pbe
    Spin Polarization:        OFF
    System charge:            Neutral

Processor Topology
   Total PEs:                 16
   X direction:               4
   Y direction:               2
   Z direction:               2
   MG Threads/PE:             2
   OMP Threads/PE:            2

Grid Points  (Linear Anisotropy: 1.000)
    X:  Total: 96   Per PE: 24   Spacing:0.188 a0  
    Y:  Total: 96   Per PE: 48   Spacing:0.188 a0  
    Z:  Total: 96   Per PE: 48   Spacing:0.188 a0  

    Equivalent energy cutoffs (psi,rho):   280.735   1122.942 Ry

    Charge density grid:         2 times finer

Coordinate planes
  Planar Anisotropy: 1.000
  A0-A1 density:    28.444
  A0-A2 density:    28.444
  A1-A2 density:    28.444


Lattice (Cell) Setup
    Type:                       Cubic_primitive
    Volume (a0^3):               5832.00
    Boundary conditions:        Periodic

    X Basis Vector:      18.000       0.000       0.000 a0
    Y Basis Vector:       0.000      18.000       0.000 a0
    Z Basis Vector:       0.000       0.000      18.000 a0
    X Reci Vector:       0.056      -0.000       0.000 a0
    Y Reci Vector:       0.000       0.056       0.000 a0
    Z Reci Vector:       0.000      -0.000       0.056 a0

K-points
    Gamma Point Only (real orbitals)

Atoms and States
    Number of ions:                          1
    Number of species:                       1
    Number of states:                        16

Run Parameters
    SCF Convergence criterion (potential):   1.00e-07
    SCF Convergence criterion (energy):      1.00e-11
    Max SCF steps:                           100

SCF Cycle Settings
    Charge density mixing:                   Broyden
    Hartree Solver:                          PFFT
    Interpolation type:                      FFT

Finite Difference parameters
    Kohn Sham FD Order:                      8   
    Force Gradient Order:                    8   
    Adaptive Finite Differencing:            On
    Adaptive CFAC:                           0.132681943

Subspace Diagonalization Options
    Frequency:                               every 1 SCF step(s)
    Driver:                                  ScaLapack
    Initial diagonalization:                 ON
    Folded spectrum:                         OFF

Filtering Cutoff  Parameters
    Wavefunction grid (cparm):               0.800
    Charge density grid (rhocparm):          1.000
    Filter factor:                           1.000

Multigrid (MG) Parameters
    Psi MG levels:                           3
    Psi global step:                         0.660 
    Psi pre:                                 2
    Psi post:                                2

Davidson Parameters
    Davidson multiplier:                     4
    Davidson max step:                       8
    Davidson unocc tol factor:               1000.000

Blas Libraries
    CPU support with openblas-parallel.


Atomic Species Information
(PP = Pseudopotential, US = Ultrasoft, NC = Norm Conserving)
-------------------------------------------------------------------------
|Index|Symbol| Mass|Valence| PP |  Comp  |Local| Local|Nlocal|    PP    |
|     |      |     |       |Type|Gaussian|  l  |Radius|Radius|Functional|
-------------------------------------------------------------------------
|    1|    Ni| 58.0|  16.00|  NC|    0.50|   -1| 10.00|  8.91|       PBE|
-------------------------------------------------------------------------

Pseudopotential generation information:
  Ni pseudopotential file: Ni_ONCV_PBE-1.0_SL.UPF
      Generation info     : Generated using ONCVPSP code by D. R. Hamann
      Author info         : anonymous


Memory usage (Mbytes):     Min        Max       Total
    wave functions         28.31      28.31     453.00
    beta-functions         39.81      39.81     637.03



Initial Ionic Positions And Displacements (Bohr)
Species      X           Y           Z           dX          dY          dZ
  Ni       0.0000      0.0000      0.0000      0.0000      0.0000      0.0000


Initial Ionic Positions And Displacements (Angstrom)
Species      X           Y           Z           dX          dY          dZ
  Ni       0.0000      0.0000      0.0000      0.0000      0.0000      0.0000

Diagonalization using scalapack for step=0  count=0



KOHN SHAM EIGENVALUES [eV] AT K-POINT [  0]:       0.000000      0.000000      0.000000

[kpt   0  -1   0]   -70.9213 [2.000]   -70.9213 [2.000]   -70.9213 [2.000]    -8.4236 [1.600]    -8.4236 [1.600]
[kpt   0  -1   1]    -8.4231 [1.600]    -8.4231 [1.600]    -8.4231 [1.600]    -5.2535 [2.000]   813.6329 [0.000]
[kpt   0  -1   2]   1632.0840 [0.000]   1694.4729 [0.000]   1755.0309 [0.000]   1854.6561 [0.000]   1913.9101 [0.000]
[kpt   0  -1   3]   1922.5032 [0.000]


Charge density mixing: Linear with a constant of 0.50 

Diagonalization using scalapack for step=0  count=1


FERMI ENERGY =     -5.26921662 eV
@@ EIGENVALUE SUM     =      -18.529490 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.289090 Ha
@@ VXC                =      -15.795244 Ha
@@ EXC                =      -12.144936 Ha
@@ TOTAL ENERGY       =     -113.344610 Ha
@@ estimated error    =   ****************
Charge density mixing: Linear with a constant of 0.50 
WriteRestart: Output file given as /dev/null, no restart data written ...


KOHN SHAM EIGENVALUES [eV] AT K-POINT [  0]:       0.000000      0.000000      0.000000

[kpt   0   0   0]   -70.9837 [2.000]   -70.9836 [2.000]   -70.9836 [2.000]    -8.4719 [1.600]    -8.4719 [1.600]
[kpt   0   0   1]    -8.4714 [1.600]    -8.4714 [1.600]    -8.4714 [1.600]    -5.2692 [2.000]     0.4791 [0.000]
[kpt   0   0   2]     8.6559 [0.000]    11.0683 [0.000]    14.6764 [0.000]    17.7647 [0.000]    21.3960 [0.000]
[kpt   0   0   3]    24.1817 [0.000]



Total charge in supercell =      16.00000000
 quench: [md:   0/100  scf:   0/100  step time:   1.63  scf time:     1.66 secs  RMS[dV]: 3.86e-03 ]


average potential <V> = -1.97e-15

Diagonalization using scalapack for step=1  count=2


FERMI ENERGY =     -5.29444200 eV
@@ EIGENVALUE SUM     =      -18.558769 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.254731 Ha
@@ VXC                =      -15.791148 Ha
@@ EXC                =      -12.141907 Ha
@@ TOTAL ENERGY       =     -113.340597 Ha
@@ estimated error    =        1.62e-05 Ha
Charge density mixing: Linear with a constant of 0.50 
 quench: [md:   0/100  scf:   1/100  step time:   1.55  scf time:     3.21 secs  RMS[dV]: 3.26e-03 ]


average potential <V> = -1.43e-15

Diagonalization using scalapack for step=2  count=3


FERMI ENERGY =     -5.30625541 eV
@@ EIGENVALUE SUM     =      -18.573548 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.239308 Ha
@@ VXC                =      -15.789379 Ha
@@ EXC                =      -12.140588 Ha
@@ TOTAL ENERGY       =     -113.340403 Ha
@@ estimated error    =        3.39e-06 Ha
Charge density mixing: Linear with a constant of 0.50 
 quench: [md:   0/100  scf:   2/100  step time:   1.68  scf time:     4.89 secs  RMS[dV]: 1.09e-03 ]


average potential <V> = 4.11e-16

Diagonalization using scalapack for step=3  count=4


FERMI ENERGY =     -5.30982137 eV
@@ EIGENVALUE SUM     =      -18.577875 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.235508 Ha
@@ VXC                =      -15.789013 Ha
@@ EXC                =      -12.140337 Ha
@@ TOTAL ENERGY       =     -113.341044 Ha
@@ estimated error    =        3.44e-07 Ha
Charge density mixing: Linear with a constant of 0.50 
 quench: [md:   0/100  scf:   3/100  step time:   1.66  scf time:     6.55 secs  RMS[dV]: 5.62e-04 ]


average potential <V> = 1.37e-15
Davidson incomplete convergence steps = 8

FERMI ENERGY =     -5.30991237 eV
@@ EIGENVALUE SUM     =      -18.577919 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.236326 Ha
@@ VXC                =      -15.789151 Ha
@@ EXC                =      -12.140492 Ha
@@ TOTAL ENERGY       =     -113.341924 Ha
@@ estimated error    =        1.03e-07 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   4/100  step time:   2.78  scf time:     9.33 secs  RMS[dV]: 3.31e-04 ]


average potential <V> = 2.24e-15
Davidson converged in 6 steps

FERMI ENERGY =     -5.30682899 eV
@@ EIGENVALUE SUM     =      -18.572659 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.241834 Ha
@@ VXC                =      -15.789936 Ha
@@ EXC                =      -12.141028 Ha
@@ TOTAL ENERGY       =     -113.341922 Ha
@@ estimated error    =        5.83e-07 Ha
Charge density mixing: Broyden


KOHN SHAM EIGENVALUES [eV] AT K-POINT [  0]:       0.000000      0.000000      0.000000

[kpt   0   5   0]   -71.0649 [2.000]   -71.0649 [2.000]   -71.0649 [2.000]    -8.5484 [1.600]    -8.5484 [1.600]
[kpt   0   5   1]    -8.5479 [1.600]    -8.5479 [1.600]    -8.5479 [1.600]    -5.3068 [2.000]    -0.0969 [0.000]
[kpt   0   5   2]    -0.0914 [0.000]    -0.0913 [0.000]    -0.0912 [0.000]     1.1564 [0.000]     1.1567 [0.000]
[kpt   0   5   3]     1.9999 [0.000]



Total charge in supercell =      16.00000000
 quench: [md:   0/100  scf:   5/100  step time:   2.48  scf time:    11.81 secs  RMS[dV]: 3.30e-04 ]


average potential <V> = -1.32e-16
Davidson converged in 3 steps

FERMI ENERGY =     -5.30645522 eV
@@ EIGENVALUE SUM     =      -18.572168 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.242335 Ha
@@ VXC                =      -15.789986 Ha
@@ EXC                =      -12.141068 Ha
@@ TOTAL ENERGY       =     -113.341922 Ha
@@ estimated error    =        1.88e-08 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   6/100  step time:   1.78  scf time:    13.60 secs  RMS[dV]: 1.43e-04 ]


average potential <V> = -2.35e-15
Davidson converged in 3 steps

FERMI ENERGY =     -5.30651480 eV
@@ EIGENVALUE SUM     =      -18.572475 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.242013 Ha
@@ VXC                =      -15.789929 Ha
@@ EXC                =      -12.141026 Ha
@@ TOTAL ENERGY       =     -113.341923 Ha
@@ estimated error    =        3.90e-09 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   7/100  step time:   1.64  scf time:    15.24 secs  RMS[dV]: 1.12e-04 ]


average potential <V> = -6.91e-16
Davidson converged in 2 steps

FERMI ENERGY =     -5.30647206 eV
@@ EIGENVALUE SUM     =      -18.572348 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.242144 Ha
@@ VXC                =      -15.789950 Ha
@@ EXC                =      -12.141042 Ha
@@ TOTAL ENERGY       =     -113.341923 Ha
@@ estimated error    =        5.64e-10 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   8/100  step time:   1.48  scf time:    16.72 secs  RMS[dV]: 1.29e-05 ]


average potential <V> = -1.63e-15
Davidson converged in 4 steps

FERMI ENERGY =     -5.30649454 eV
@@ EIGENVALUE SUM     =      -18.572337 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.242157 Ha
@@ VXC                =      -15.789955 Ha
@@ EXC                =      -12.141046 Ha
@@ TOTAL ENERGY       =     -113.341923 Ha
@@ estimated error    =        3.55e-11 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   9/100  step time:   2.23  scf time:    18.95 secs  RMS[dV]: 8.29e-06 ]



 Convergence criterion reached: Energy variation (2.56e-12) is lower than threshold (1.00e-11)

potential convergence has been achieved. stopping ...

[   0  10   10       21 ] Quench.cpp: final total energy from eig sum =    -113.34192289 Ha


KOHN SHAM EIGENVALUES [eV] AT K-POINT [  0]:       0.000000      0.000000      0.000000

[kpt   0  10   0]   -71.0644 [2.000]   -71.0644 [2.000]   -71.0644 [2.000]    -8.5478 [1.600]    -8.5478 [1.600]
[kpt   0  10   1]    -8.5472 [1.600]    -8.5472 [1.600]    -8.5472 [1.600]    -5.3065 [2.000]    -0.1012 [0.000]
[kpt   0  10   2]    -0.0920 [0.000]    -0.0920 [0.000]    -0.0920 [0.000]     1.1512 [0.000]     1.1512 [0.000]
[kpt   0  10   3]     1.9983 [0.000]



Total charge in supercell =      16.00000000
 volume and energy per atom =       864.21323680      -3084.19064381 eV

 Vdd took 0.001476 seconds
WriteRestart: Output file given as /dev/null, no restart data written ...



  IONIC POSITIONS [a0] AND FORCES [Ha/a0]
  Charge analysis using: Voronoi Deformation Density

@ION  Ion  Species       X           Y           Z       Charge       FX          FY         FZ      Movable
@ION    1    Ni      0.0000000   0.0000000   0.0000000   -0.000    0.0000000   0.0000000   0.0000000  1 1 1

 mean FX      =   0.00000000 Ha/a0
 mean FY      =   0.00000000 Ha/a0
 mean FZ      =   0.00000000 Ha/a0

 max FX       =   0.00000000 Ha/a0   (ion 1)
 max FY       =   0.00000000 Ha/a0   (ion 1)
 max FZ       =   0.00000000 Ha/a0   (ion 1)
 max F[x,y,z] =   0.00000000 Ha/a0
 max |F|      =   0.00000000 Ha/a0   (ion 1)

WriteRestart: Output file given as /dev/null, no restart data written ...


--------TIMING INFORMATION FOR Processor owned the most atoms----------------
                                        Total time               Per SCF/step

1-TOTAL                                            21.63                2.16
-----------------------------------------------------------------------------
  1-TOTAL: Init                                     2.42                0.24
  1-TOTAL: run                                     19.21                1.92
  ---------------------------------------------------------------------------
    1-TOTAL: run: Force                             0.17                0.02
    1-TOTAL: run: Scf steps                        18.92                1.89

2-Force                                             0.17                0.02
-----------------------------------------------------------------------------
  2-Force: core correction                          0.00                0.00
  2-Force: corrections                              0.04                0.00
  2-Force: ion-ion                                  0.02                0.00
  2-Force: local                                    0.05                0.01
  2-Force: non-local                                0.06                0.01
  2-Force: non-local-betaxpsi                       0.03                0.00
  2-Force: non-local-get gamma                      0.00                0.00
  2-Force: non-local-nlforce_par_Q                  0.01                0.00
  2-Force: non-local-nlforce_par_gamma              0.00                0.00
  2-Force: non-local-nlforce_par_omega              0.00                0.00
  2-Force: non-local-partial gamma                  0.00                0.00
  2-Force: non-local-veff grad                      0.01                0.00

2-Init                                              2.42                0.24
-----------------------------------------------------------------------------
  2-Init: GetNewRho                                 0.15                0.01
  2-Init: KpointClass                               0.37                0.04
  2-Init: LcaoGetPsi                                0.04                0.00
  2-Init: LcaoGetRho                                0.03                0.00
  2-Init: ReinitIonicPotentials                     0.44                0.04
  2-Init: betaxpsi                                  0.03                0.00
  2-Init: exchange/correlation                      0.28                0.03
  2-Init: hartree                                   0.28                0.03
  2-Init: normalization                             0.00                0.00
  2-Init: radial potentials                         0.17                0.02
  2-Init: subdiag                                   0.12                0.01
  2-Init: weights                                   0.22                0.02

2-Scf steps                                        18.92                1.89
-----------------------------------------------------------------------------
  2-Scf steps: Davidson                             7.08                0.71
  2-Scf steps: GetNewRho                            1.66                0.17
  2-Scf steps: Hartree                              3.76                0.38
  2-Scf steps: MgridSubspace                        2.97                0.30
  2-Scf steps: MixRho                               0.21                0.02
  2-Scf steps: exchange/correlation                 2.05                0.21

3-MgridSubspace                                     2.97                0.30
-----------------------------------------------------------------------------
  3-MgridSubspace: AppNls                           0.18                0.02
  3-MgridSubspace: Beta x psi                       0.32                0.03
  3-MgridSubspace: Diagonalization                  0.38                0.04
  3-MgridSubspace: Mg_eig                           0.00                0.00

3-ReinitIonicPotentials                             0.44                0.04
-----------------------------------------------------------------------------
  3-ReinitIonicPotentials: GetNlop                  0.02                0.00
  3-ReinitIonicPotentials: GetWeight                0.32                0.03
  3-ReinitIonicPotentials: get_QI                   0.00                0.00
  3-ReinitIonicPotentials: get_qqq                  0.00                0.00
  3-ReinitIonicPotentials: init_nuc                 0.10                0.01

4-Diagonalization                                   0.50                0.05
-----------------------------------------------------------------------------
  4-Diagonalization: ELPA/PDSYGVX/PZHEGVX           0.01                0.00
  4-Diagonalization: Hpsi                           0.29                0.03
  4-Diagonalization: MPI_Bcast                      0.00                0.00
  4-Diagonalization: Update orbitals                0.04                0.00
  ---------------------------------------------------------------------------
    4-Diagonalization: Update orbitals: gather           0.00                0.00
    4-Diagonalization: Update orbitals: gemm           0.03                0.00
  4-Diagonalization: matrix                         0.15                0.02
  ---------------------------------------------------------------------------
    4-Diagonalization: matrix: Allreduce            0.08                0.01
    4-Diagonalization: matrix: Gemm                 0.07                0.01

5-Functional                                        2.25                0.22
-----------------------------------------------------------------------------
  5-Functional: apply gradient                      0.27                0.03
  5-Functional: apply laplacian                     0.09                0.01
  5-Functional: libxc                               0.33                0.03
  5-Functional: vxc                                 2.22                0.22
  5-Functional: vxc grad                            0.82                0.08
  5-Functional: vxc local                           0.24                0.02
  5-Functional: vxc nonlocal                        0.00                0.00

6-Davidson                                          7.08                0.71
-----------------------------------------------------------------------------
  6-Davidson: Betaxpsi                              0.68                0.07
  6-Davidson: apply hamiltonian                     1.85                0.19
  6-Davidson: diagonalization                       0.06                0.01
  6-Davidson: generate residuals                    0.22                0.02
  6-Davidson: matrix setup/reduce                   0.67                0.07
  6-Davidson: normalization                         0.29                0.03
  6-Davidson: precondition                          3.23                0.32
  6-Davidson: refresh h_psi and s_psi               0.01                0.00
  6-Davidson: reset hr,sr,vr                        0.00                0.00
  6-Davidson: rotate orbitals                       0.06                0.01

AppNls                                              0.54                0.05
-----------------------------------------------------------------------------
  AppNls: data_rearrange                            0.00                0.00
  ---------------------------------------------------------------------------
    AppNls: data_rearrange: alloc and zeros           0.00                0.00
    AppNls: data_rearrange: dnm                     0.00                0.00
    AppNls: data_rearrange: sint                    0.00                0.00
  AppNls: nv                                        0.50                0.05
  AppNls: nv_work                                   0.00                0.00

App_gradient                                        0.31                0.03

Compute Hpsi                                        0.29                0.03
-----------------------------------------------------------------------------
  Compute Hpsi: AppNls                              0.06                0.01
  Compute Hpsi: Threaded Apply H                    0.23                0.02

GlobalSums                                          0.10                0.01

Init                                                2.05                0.21

Init Voronoi                                        0.03                0.00

Mix rho                                             0.22                0.02
-----------------------------------------------------------------------------
  Mix rho: Broyden                                  0.16                0.02
  Mix rho: Linear                                   0.01                0.00

Orbital                                             0.02                0.00
-----------------------------------------------------------------------------
  Orbital: phase and set                            0.02                0.00
  Orbital: proj cal                                 0.02                0.00

VhPfft                                              1.97                0.20

Weight                                              0.20                0.02

radial beta                                         0.09                0.01


------------------------- TIMING INFORMATION FOR THREADS  -------------------

                                           Min            Max            Avg
GlobalSums                               1.84           1.84           0.92
-----------------------------------------------------------------------------

Mg_eig                                   2.06           2.06           1.03
-----------------------------------------------------------------------------
  Mg_eig: apply hamiltonian              0.68           0.68           0.34
  Mg_eig: mgrid_solv                     0.38           0.38           0.19

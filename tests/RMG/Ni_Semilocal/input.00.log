RMG initialization ... 1 image(s) total, 1 per node. 24 MPI processes/image. Thread level 2.


                     * * * * * * * * * *
                     *    R   M   G    *
                     * * * * * * * * * *

     -- A Real Space Multigrid Electronic structure code --
     --      More information at www.rmgdft.org          --

Code Revision:     v4.0.0_beta_1429_g1c94fe76
Build Date:        Nov 23 2022  08:43:49
Start time:        Wed Nov 23 08:51:15 2022

NOTICE: RMG internal pseudopotentials have switched to
ONCVP from Ultrasoft. You can revert to Ultrasoft by
adding the input tag internal_pseudo_type="ultrasoft" to
your input files.


Files
   Control input file:        input
   Data output file:          /dev/null

Run Setup
    Calculation type:         Quench electrons - Fixed ions SCF calculation
    Description:              Nickel atom test using semi-local potential
    Orbital Initialization:   LCAO (9 LCAO and 0 random orbitals)
    Exchange Correlation:     pbe
    Spin Polarization:        OFF
    System charge:            Neutral

Processor Topology
   Total PEs:                 24
   X direction:               6
   Y direction:               2
   Z direction:               2
   MG Threads/PE:             1
   OMP Threads/PE:            1

Grid Points  (Linear Anisotropy: 1.000)
    X:  Total: 96   Per PE: 16   Spacing:0.188 a0  
    Y:  Total: 96   Per PE: 48   Spacing:0.188 a0  
    Z:  Total: 96   Per PE: 48   Spacing:0.188 a0  

    Equivalent energy cutoffs (psi,rho):   280.735   1122.942 Ry

    Charge density grid:         2 times finer

Coordinate planes
  Planar Anisotropy: 1.000
  A0-A1 density:    28.444
  A0-A2 density:    28.444
  A1-A2 density:    28.444


Lattice (Cell) Setup
    Type:                       Cubic_primitive
    Volume (a0^3):               5832.00
    Boundary conditions:        Periodic

    X Basis Vector:      18.000       0.000       0.000 a0
    Y Basis Vector:       0.000      18.000       0.000 a0
    Z Basis Vector:       0.000       0.000      18.000 a0
    X Reci Vector:       0.056      -0.000       0.000 a0
    Y Reci Vector:       0.000       0.056       0.000 a0
    Z Reci Vector:       0.000      -0.000       0.056 a0

K-points
    Gamma Point Only (real orbitals)

Atoms and States
    Number of ions:                          1
    Number of species:                       1
    Number of states:                        16

Run Parameters
    SCF Convergence criterion (potential):   1.00e-07
    SCF Convergence criterion (energy):      1.00e-11
    Max SCF steps:                           100

SCF Cycle Settings
    Charge density mixing:                   Broyden
    Hartree Solver:                          PFFT
    Interpolation type:                      FFT

Subspace Diagonalization Options
    Frequency:                               every 1 SCF step(s)
    Driver:                                  ScaLapack
    Initial diagonalization:                 ON
    Folded spectrum:                         OFF

Filtering Cutoff  Parameters
    Wavefunction grid (cparm):               0.800
    Charge density grid (rhocparm):          1.000
    Filter factor:                           1.000

Multigrid (MG) Parameters
    Psi MG levels:                           3
    Psi global step:                         0.660 
    Psi pre:                                 2
    Psi post:                                2

Davidson Parameters
    Davidson multiplier:                     4
    Davidson max step:                       8
    Davidson unocc tol factor:               1000.000

Blas Libraries
    CPU support with openblas-parallel.


Atomic Species Information
(PP = Pseudopotential, US = Ultrasoft, NC = Norm Conserving)
-------------------------------------------------------------------------
|Index|Symbol| Mass|Valence| PP |  Comp  |Local| Local|Nlocal|    PP    |
|     |      |     |       |Type|Gaussian|  l  |Radius|Radius|Functional|
-------------------------------------------------------------------------
|    1|    Ni| 58.0|  16.00|  NC|    0.50|   -1| 10.00|  8.91|       PBE|
-------------------------------------------------------------------------

Pseudopotential generation information:
  Ni pseudopotential file: Ni_ONCV_PBE-1.0_SL.UPF
      Generation info     : Generated using ONCVPSP code by D. R. Hamann
      Author info         : anonymous


Memory usage (Mbytes):     Min        Max       Total
    wave functions         18.88      18.88     453.01
    beta-functions         26.54      26.54     637.03



Initial Ionic Positions And Displacements (Bohr)
Species      X           Y           Z           dX          dY          dZ
  Ni       0.0000      0.0000      0.0000      0.0000      0.0000      0.0000


Initial Ionic Positions And Displacements (Angstrom)
Species      X           Y           Z           dX          dY          dZ
  Ni       0.0000      0.0000      0.0000      0.0000      0.0000      0.0000

Diagonalization using scalapack for step=0  count=1



KOHN SHAM EIGENVALUES [eV] AT K-POINT [  0]:       0.000000      0.000000      0.000000

[kpt   0  -1   0]   -70.9213 [2.000]   -70.9213 [2.000]   -70.9213 [2.000]    -8.4235 [1.600]    -8.4235 [1.600]
[kpt   0  -1   1]    -8.4230 [1.600]    -8.4230 [1.600]    -8.4230 [1.600]    -5.2479 [2.000]   813.7041 [0.000]
[kpt   0  -1   2]   1632.2214 [0.000]   1694.6095 [0.000]   1755.1851 [0.000]   1854.8160 [0.000]   1914.0788 [0.000]
[kpt   0  -1   3]   1922.6746 [0.000]


Charge density mixing: Linear with a constant of 0.50 

 charge density is NEGATIVE after interpolation, minimum is -7.107210e-09
 minimum charge density with core charge added is -7.107210e-09

Diagonalization using scalapack for step=0  count=2


FERMI ENERGY =     -5.26862679 eV
@@ EIGENVALUE SUM     =      -18.529190 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.289183 Ha
@@ VXC                =      -15.795317 Ha
@@ EXC                =      -12.144945 Ha
@@ TOTAL ENERGY       =     -113.344340 Ha
@@ estimated error    =   ****************
Charge density mixing: Linear with a constant of 0.50 
WriteRestart: Output file given as /dev/null, no restart data written ...


KOHN SHAM EIGENVALUES [eV] AT K-POINT [  0]:       0.000000      0.000000      0.000000

[kpt   0   0   0]   -70.9830 [2.000]   -70.9830 [2.000]   -70.9830 [2.000]    -8.4715 [1.600]    -8.4715 [1.600]
[kpt   0   0   1]    -8.4710 [1.600]    -8.4710 [1.600]    -8.4710 [1.600]    -5.2686 [2.000]     0.4816 [0.000]
[kpt   0   0   2]     8.6578 [0.000]    11.0702 [0.000]    14.6794 [0.000]    17.7674 [0.000]    21.3980 [0.000]
[kpt   0   0   3]    24.1837 [0.000]



Total charge in supercell =      16.00000000
 quench: [md:   0/100  scf:   0/100  step time:   0.93  scf time:     0.95 secs  RMS[dV]: 7.46e-03 ]


average potential <V> = -2.80e-16

Diagonalization using scalapack for step=1  count=3


FERMI ENERGY =     -5.29448444 eV
@@ EIGENVALUE SUM     =      -18.558669 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.254794 Ha
@@ VXC                =      -15.791160 Ha
@@ EXC                =      -12.141908 Ha
@@ TOTAL ENERGY       =     -113.340550 Ha
@@ estimated error    =        1.63e-05 Ha
Charge density mixing: Linear with a constant of 0.50 
 quench: [md:   0/100  scf:   1/100  step time:   0.84  scf time:     1.79 secs  RMS[dV]: 4.84e-03 ]


average potential <V> = 1.09e-15

Diagonalization using scalapack for step=2  count=4


FERMI ENERGY =     -5.30626773 eV
@@ EIGENVALUE SUM     =      -18.573453 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.239387 Ha
@@ VXC                =      -15.789379 Ha
@@ EXC                =      -12.140588 Ha
@@ TOTAL ENERGY       =     -113.340386 Ha
@@ estimated error    =        3.38e-06 Ha
Charge density mixing: Linear with a constant of 0.50 
 quench: [md:   0/100  scf:   2/100  step time:   0.84  scf time:     2.62 secs  RMS[dV]: 1.96e-03 ]


average potential <V> = -1.81e-16

Diagonalization using scalapack for step=3  count=5


FERMI ENERGY =     -5.30983442 eV
@@ EIGENVALUE SUM     =      -18.577780 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.235587 Ha
@@ VXC                =      -15.788978 Ha
@@ EXC                =      -12.140336 Ha
@@ TOTAL ENERGY       =     -113.341062 Ha
@@ estimated error    =        3.42e-07 Ha
Charge density mixing: Linear with a constant of 0.50 
 quench: [md:   0/100  scf:   3/100  step time:   0.84  scf time:     3.46 secs  RMS[dV]: 8.34e-03 ]


average potential <V> = 7.89e-16
Davidson incomplete convergence steps = 8

FERMI ENERGY =     -5.30992425 eV
@@ EIGENVALUE SUM     =      -18.577826 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.236406 Ha
@@ VXC                =      -15.789039 Ha
@@ EXC                =      -12.140491 Ha
@@ TOTAL ENERGY       =     -113.342022 Ha
@@ estimated error    =        1.02e-07 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   4/100  step time:   1.12  scf time:     4.58 secs  RMS[dV]: 4.66e-02 ]


average potential <V> = -1.48e-16
Davidson converged in 4 steps

FERMI ENERGY =     -5.30684654 eV
@@ EIGENVALUE SUM     =      -18.572568 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.241915 Ha
@@ VXC                =      -15.789935 Ha
@@ EXC                =      -12.141026 Ha
@@ TOTAL ENERGY       =     -113.341911 Ha
@@ estimated error    =        5.85e-07 Ha
Charge density mixing: Broyden


KOHN SHAM EIGENVALUES [eV] AT K-POINT [  0]:       0.000000      0.000000      0.000000

[kpt   0   5   0]   -71.0646 [2.000]   -71.0646 [2.000]   -71.0646 [2.000]    -8.5483 [1.600]    -8.5483 [1.600]
[kpt   0   5   1]    -8.5478 [1.600]    -8.5478 [1.600]    -8.5478 [1.600]    -5.3068 [2.000]    -0.0970 [0.000]
[kpt   0   5   2]    -0.0914 [0.000]    -0.0912 [0.000]    -0.0911 [0.000]     1.1563 [0.000]     1.1566 [0.000]
[kpt   0   5   3]     2.0061 [0.000]



Total charge in supercell =      16.00000000
 quench: [md:   0/100  scf:   5/100  step time:   0.84  scf time:     5.42 secs  RMS[dV]: 5.49e-02 ]


average potential <V> = 1.40e-16
Davidson converged in 3 steps

FERMI ENERGY =     -5.30647505 eV
@@ EIGENVALUE SUM     =      -18.572084 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.242408 Ha
@@ VXC                =      -15.789985 Ha
@@ EXC                =      -12.141066 Ha
@@ TOTAL ENERGY       =     -113.341911 Ha
@@ estimated error    =        1.89e-08 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   6/100  step time:   0.78  scf time:     6.20 secs  RMS[dV]: 3.19e-04 ]


average potential <V> = -5.51e-16
Davidson converged in 3 steps

FERMI ENERGY =     -5.30653267 eV
@@ EIGENVALUE SUM     =      -18.572389 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.242088 Ha
@@ VXC                =      -15.789928 Ha
@@ EXC                =      -12.141024 Ha
@@ TOTAL ENERGY       =     -113.341911 Ha
@@ estimated error    =        3.96e-09 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   7/100  step time:   0.79  scf time:     6.99 secs  RMS[dV]: 2.57e-04 ]


average potential <V> = 1.43e-15
Davidson converged in 3 steps

FERMI ENERGY =     -5.30649003 eV
@@ EIGENVALUE SUM     =      -18.572267 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.242214 Ha
@@ VXC                =      -15.789948 Ha
@@ EXC                =      -12.141040 Ha
@@ TOTAL ENERGY       =     -113.341911 Ha
@@ estimated error    =        5.60e-10 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   8/100  step time:   0.80  scf time:     7.78 secs  RMS[dV]: 7.37e-05 ]


average potential <V> = -1.00e-15
Davidson converged in 3 steps

FERMI ENERGY =     -5.30650720 eV
@@ EIGENVALUE SUM     =      -18.572233 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.242250 Ha
@@ VXC                =      -15.789958 Ha
@@ EXC                =      -12.141048 Ha
@@ TOTAL ENERGY       =     -113.341911 Ha
@@ estimated error    =        5.28e-11 Ha
Charge density mixing: Broyden
 quench: [md:   0/100  scf:   9/100  step time:   0.82  scf time:     8.60 secs  RMS[dV]: 6.71e-05 ]


average potential <V> = -4.85e-16
Davidson converged in 3 steps

FERMI ENERGY =     -5.30651184 eV
@@ EIGENVALUE SUM     =      -18.572249 Ha
@@ ION_ION            =      -20.176338 Ha
@@ ELECTROSTATIC      =      -78.242233 Ha
@@ VXC                =      -15.789955 Ha
@@ EXC                =      -12.141046 Ha
@@ TOTAL ENERGY       =     -113.341911 Ha
@@ estimated error    =        1.25e-11 Ha
Charge density mixing: Broyden


KOHN SHAM EIGENVALUES [eV] AT K-POINT [  0]:       0.000000      0.000000      0.000000

[kpt   0  10   0]   -71.0642 [2.000]   -71.0642 [2.000]   -71.0642 [2.000]    -8.5477 [1.600]    -8.5477 [1.600]
[kpt   0  10   1]    -8.5471 [1.600]    -8.5471 [1.600]    -8.5471 [1.600]    -5.3065 [2.000]    -0.1012 [0.000]
[kpt   0  10   2]    -0.0920 [0.000]    -0.0920 [0.000]    -0.0920 [0.000]     1.1512 [0.000]     1.1512 [0.000]
[kpt   0  10   3]     2.0023 [0.000]



Total charge in supercell =      16.00000000
 quench: [md:   0/100  scf:  10/100  step time:   0.89  scf time:     9.49 secs  RMS[dV]: 2.70e-05 ]



 Convergence criterion reached: Energy variation (1.36e-12) is lower than threshold (1.00e-11)

potential convergence has been achieved. stopping ...

[   0  11   11       12 ] Quench.cpp: final total energy =    -113.34191089 Ha


KOHN SHAM EIGENVALUES [eV] AT K-POINT [  0]:       0.000000      0.000000      0.000000

[kpt   0  11   0]   -71.0642 [2.000]   -71.0642 [2.000]   -71.0642 [2.000]    -8.5477 [1.600]    -8.5477 [1.600]
[kpt   0  11   1]    -8.5471 [1.600]    -8.5471 [1.600]    -8.5471 [1.600]    -5.3065 [2.000]    -0.1012 [0.000]
[kpt   0  11   2]    -0.0920 [0.000]    -0.0920 [0.000]    -0.0920 [0.000]     1.1512 [0.000]     1.1512 [0.000]
[kpt   0  11   3]     2.0023 [0.000]



Total charge in supercell =      16.00000000
 volume and energy per atom =       864.21323680      -3084.19031709 eV

 Vdd took 0.001178 seconds
WriteRestart: Output file given as /dev/null, no restart data written ...



  IONIC POSITIONS [a0] AND FORCES [Ha/a0]
  Charge analysis using: Voronoi Deformation Density

@ION  Ion  Species       X           Y           Z       Charge       FX          FY         FZ      Movable
@ION    1    Ni      0.0000000   0.0000000   0.0000000   -0.000    0.0000000   0.0000000   0.0000000  1 1 1

 mean FX      =   0.00000000 Ha/a0
 mean FY      =   0.00000000 Ha/a0
 mean FZ      =   0.00000000 Ha/a0

 max FX       =   0.00000000 Ha/a0   (ion 1)
 max FY       =   0.00000000 Ha/a0   (ion 1)
 max FZ       =   0.00000000 Ha/a0   (ion 1)
 max F[x,y,z] =   0.00000000 Ha/a0
 max |F|      =   0.00000000 Ha/a0   (ion 1)

WriteRestart: Output file given as /dev/null, no restart data written ...


--------TIMING INFORMATION FOR Processor owned the most atoms----------------
                                        Total time               Per SCF/step

1-TOTAL                                            16.15                1.47
-----------------------------------------------------------------------------
  1-TOTAL: Init                                     2.27                0.21
  1-TOTAL: run                                     13.89                1.26
  ---------------------------------------------------------------------------
    1-TOTAL: run: Force                             0.20                0.02
    1-TOTAL: run: Scf steps                         9.48                0.86

2-Force                                             0.20                0.02
-----------------------------------------------------------------------------
  2-Force: core correction                          0.02                0.00
  2-Force: corrections                              0.04                0.00
  2-Force: ion-ion                                  0.01                0.00
  2-Force: local                                    0.06                0.01
  2-Force: non-local                                0.07                0.01
  2-Force: non-local-betaxpsi                       0.03                0.00
  2-Force: non-local-get gamma                      0.00                0.00
  2-Force: non-local-nlforce_par_Q                  0.01                0.00
  2-Force: non-local-nlforce_par_gamma              0.00                0.00
  2-Force: non-local-nlforce_par_omega              0.00                0.00
  2-Force: non-local-partial gamma                  0.00                0.00
  2-Force: non-local-veff grad                      0.01                0.00

2-Init                                              2.27                0.21
-----------------------------------------------------------------------------
  2-Init: GetNewRho                                 0.04                0.00
  2-Init: KpointClass                               0.66                0.06
  2-Init: LcaoGetPsi                                0.03                0.00
  2-Init: LcaoGetRho                                0.01                0.00
  2-Init: ReinitIonicPotentials                     0.41                0.04
  2-Init: betaxpsi                                  0.02                0.00
  2-Init: exchange/correlation                      0.19                0.02
  2-Init: hartree                                   0.22                0.02
  2-Init: normalization                             0.00                0.00
  2-Init: radial potentials                         0.16                0.01
  2-Init: subdiag                                   0.14                0.01
  2-Init: weights                                   0.11                0.01

2-Scf steps                                         9.48                0.86
-----------------------------------------------------------------------------
  2-Scf steps: Davidson                             2.31                0.21
  2-Scf steps: GetNewRho                            0.36                0.03
  2-Scf steps: Hartree                              2.42                0.22
  2-Scf steps: MgridSubspace                        1.52                0.14
  2-Scf steps: MixRho                               0.33                0.03
  2-Scf steps: exchange/correlation                 1.08                0.10

3-MgridSubspace                                     1.52                0.14
-----------------------------------------------------------------------------
  3-MgridSubspace: AppNls                           0.19                0.02
  3-MgridSubspace: Beta x psi                       0.20                0.02
  3-MgridSubspace: Diagonalization                  0.17                0.02
  3-MgridSubspace: Mg_eig                           0.92                0.08

3-ReinitIonicPotentials                             0.41                0.04
-----------------------------------------------------------------------------
  3-ReinitIonicPotentials: GetNlop                  0.02                0.00
  3-ReinitIonicPotentials: GetWeight                0.28                0.03
  3-ReinitIonicPotentials: get_QI                   0.00                0.00
  3-ReinitIonicPotentials: get_qqq                  0.00                0.00
  3-ReinitIonicPotentials: init_nuc                 0.11                0.01

4-Diagonalization                                   0.31                0.03
-----------------------------------------------------------------------------
  4-Diagonalization: AppNls                         0.09                0.01
  4-Diagonalization: Eigensolver                    0.04                0.00
  4-Diagonalization: MPI_Bcast                      0.00                0.00
  4-Diagonalization: PDSYGVX/PZHEGVX                0.00                0.00
  4-Diagonalization: Update orbitals                0.05                0.00
  4-Diagonalization: apply operators                0.19                0.02
  4-Diagonalization: distribute matrices.           0.00                0.00
  4-Diagonalization: matrix setup/reduce            0.03                0.00
  4-Diagonalization: scalapack                      0.04                0.00

5-Functional                                        1.18                0.11
-----------------------------------------------------------------------------
  5-Functional: apply gradient                      0.23                0.02
  5-Functional: apply laplacian                     0.09                0.01
  5-Functional: libxc                               0.40                0.04
  5-Functional: vxc                                 1.13                0.10
  5-Functional: vxc grad                            0.86                0.08
  5-Functional: vxc local                           0.23                0.02
  5-Functional: vxc nonlocal                        0.00                0.00

6-Davidson                                          2.31                0.21
-----------------------------------------------------------------------------
  6-Davidson: Betaxpsi                              0.46                0.04
  6-Davidson: apply hamiltonian                     0.71                0.06
  6-Davidson: diagonalization                       0.04                0.00
  6-Davidson: generate residuals                    0.28                0.03
  6-Davidson: matrix setup/reduce                   0.29                0.03
  6-Davidson: normalization                         0.03                0.00
  6-Davidson: precondition                          0.36                0.03
  6-Davidson: refresh h_psi and s_psi               0.03                0.00
  6-Davidson: reset hr,sr,vr                        0.00                0.00
  6-Davidson: rotate orbitals                       0.11                0.01

AppNls                                              0.74                0.07
-----------------------------------------------------------------------------
  AppNls: data_rearrange                            0.00                0.00
  ---------------------------------------------------------------------------
    AppNls: data_rearrange: alloc and zeros           0.00                0.00
    AppNls: data_rearrange: dnm                     0.00                0.00
    AppNls: data_rearrange: sint                    0.00                0.00
  AppNls: nv                                        0.67                0.06
  AppNls: nv_work                                   0.00                0.00

App_gradient                                        0.29                0.03

GlobalSums                                          0.11                0.01

Init                                                1.61                0.15

Init Voronoi                                        0.02                0.00

Mix rho                                             0.33                0.03
-----------------------------------------------------------------------------
  Mix rho: Broyden                                  0.30                0.03
  Mix rho: Linear                                   0.02                0.00

Orbital                                             0.01                0.00
-----------------------------------------------------------------------------
  Orbital: phase and set                            0.01                0.00
  Orbital: proj cal                                 0.01                0.00

VhPfft                                              2.45                0.22

Weight                                              0.10                0.01

radial beta                                         0.11                0.01


------------------------- TIMING INFORMATION FOR THREADS  -------------------

                                           Min            Max            Avg
GlobalSums                               0.08           0.08           0.08
-----------------------------------------------------------------------------

Mg_eig                                   0.91           0.91           0.91
-----------------------------------------------------------------------------
  Mg_eig: apply hamiltonian              0.50           0.50           0.50
  Mg_eig: mgrid_solv                     0.11           0.11           0.11
